<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mount Meru Room Booking â€” Teams Setup</title>
  <script src="https://res.cdn.office.net/teams-js/2.22.0/js/MicrosoftTeams.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Open+Sans:wght@400;600;700&display=swap');

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Open Sans', 'Segoe UI', sans-serif;
      background: #F7F7F7;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 24px;
    }

    .card {
      background: white;
      border-radius: 16px;
      padding: 36px 40px;
      max-width: 440px;
      width: 100%;
      box-shadow: 0 4px 28px rgba(0,0,0,.09);
      border-top: 4px solid #CC1515;
    }

    /* Logo */
    .logo { display: flex; align-items: center; gap: 12px; margin-bottom: 28px; }
    .logo-title { font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 800; color: #231F20; }
    .logo-sub   { font-size: 10px; color: #CC1515; letter-spacing: 2.5px; text-transform: uppercase; margin-top: 2px; font-weight: 700; }

    /* Headings */
    h2 { font-size: 16px; font-weight: 700; color: #231F20; margin-bottom: 6px; font-family: 'Montserrat', sans-serif; }
    .desc { font-size: 13px; color: #777; line-height: 1.65; margin-bottom: 24px; }

    /* Option list */
    .options { display: flex; flex-direction: column; gap: 10px; margin-bottom: 28px; }
    .option {
      display: flex; align-items: center; gap: 14px;
      padding: 13px 16px; border-radius: 10px; border: 2px solid #E8E8E8;
      cursor: pointer; transition: all .15s; user-select: none;
    }
    .option:hover  { border-color: #CC1515; background: #FFF6F6; }
    .option.active { border-color: #CC1515; background: #FFF0F0; box-shadow: 0 0 0 3px rgba(204,21,21,.1); }

    .opt-dot  { width: 12px; height: 12px; border-radius: 50%; flex-shrink: 0; }
    .opt-body { flex: 1; }
    .opt-name { font-size: 14px; font-weight: 700; color: #231F20; }
    .opt-desc { font-size: 11px; color: #AAA; margin-top: 2px; }

    /* Radio indicator */
    .opt-radio {
      width: 18px; height: 18px; border-radius: 50%; border: 2px solid #DDDDDD;
      display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: border .15s;
    }
    .option.active .opt-radio { border-color: #CC1515; }
    .opt-radio-dot {
      width: 8px; height: 8px; border-radius: 50%; background: #CC1515;
      display: none;
    }
    .option.active .opt-radio-dot { display: block; }

    .footer-note {
      text-align: center; font-size: 11px; color: #BBBBBB;
      padding: 12px 0 0; border-top: 1px solid #EEEEEE;
    }
    .tip {
      background: #FFF8E1; border-radius: 8px; padding: 10px 14px;
      font-size: 12px; color: #9A6F00; margin-bottom: 24px; line-height: 1.5;
    }
  </style>
</head>
<body>
<div class="card">
  <div class="logo">
    <svg width="44" height="44" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="40" height="40" rx="9" fill="white" stroke="#E8E8E8" stroke-width="1"/>
      <path d="M4 32V17C4 14 6 12 9 12C11.5 12 13.5 13.5 14.5 15.5C15.5 13.5 17.5 12 20 12C22.5 12 24.5 13.5 25.5 15.5C26.5 13.5 28.5 12 31 12C34 12 36 14 36 17V32H31.5V18.5C31.5 17 30.5 16 29.5 16C28.5 16 27.5 17 27.5 18.5V32H23V18.5C23 17 22 16 21 16C20 16 19 17 19 18.5V32H14.5V18.5C14.5 17 13.5 16 12.5 16C11.5 16 10.5 17 10.5 18.5V32H4Z" fill="#CC1515"/>
      <ellipse cx="31.5" cy="13" rx="4" ry="5.5" fill="#F7B731" transform="rotate(-8 31.5 13)"/>
    </svg>
    <div>
      <div class="logo-title">Mount Meru</div>
      <div class="logo-sub">Room Booking</div>
    </div>
  </div>

  <h2>Configure this Teams tab</h2>
  <p class="desc">
    Choose which rooms to display in this tab. You can add multiple tabs â€” one per room â€” or a
    single tab showing all rooms. All users in your organization will share the same view.
  </p>

  <div class="tip">
    ðŸ’¡ For all-in-one access, choose <strong>All Rooms</strong>. To dedicate a channel to a specific
    meeting room, choose that room below.
  </div>

  <div class="options" id="options">
    <div class="option active" data-url="https://mountmeru-rooms.vercel.app" data-name="All Rooms">
      <div class="opt-dot" style="background:#231F20"></div>
      <div class="opt-body">
        <div class="opt-name">All Rooms</div>
        <div class="opt-desc">Serengeti (7p) Â· Tarangire (3p) Â· Ruaha (2p)</div>
      </div>
      <div class="opt-radio"><div class="opt-radio-dot"></div></div>
    </div>

    <div class="option" data-url="https://mountmeru-rooms.vercel.app?room=serengeti" data-name="Serengeti">
      <div class="opt-dot" style="background:#CC1515"></div>
      <div class="opt-body">
        <div class="opt-name">Serengeti</div>
        <div class="opt-desc">Large conference room Â· 7 person max</div>
      </div>
      <div class="opt-radio"><div class="opt-radio-dot"></div></div>
    </div>

    <div class="option" data-url="https://mountmeru-rooms.vercel.app?room=tarangire" data-name="Tarangire">
      <div class="opt-dot" style="background:#5BA89C"></div>
      <div class="opt-body">
        <div class="opt-name">Tarangire</div>
        <div class="opt-desc">Small meeting room Â· 3 person max</div>
      </div>
      <div class="opt-radio"><div class="opt-radio-dot"></div></div>
    </div>

    <div class="option" data-url="https://mountmeru-rooms.vercel.app?room=ruaha" data-name="Ruaha">
      <div class="opt-dot" style="background:#E8963C"></div>
      <div class="opt-body">
        <div class="opt-name">Ruaha</div>
        <div class="opt-desc">Huddle room Â· 2 person max</div>
      </div>
      <div class="opt-radio"><div class="opt-radio-dot"></div></div>
    </div>
  </div>

  <p class="footer-note">Click <strong>Save</strong> in the Teams dialog above to confirm your selection.</p>
</div>

<script>
  let selectedUrl  = "https://mountmeru-rooms.vercel.app";
  let selectedName = "All Rooms";

  // Initialize Teams SDK
  microsoftTeams.app.initialize().then(() => {
    microsoftTeams.pages.config.registerOnSaveHandler(saveEvent => {
      microsoftTeams.pages.config.setConfig({
        suggestedDisplayName: selectedName,
        entityId: "mountmeru-" + selectedName.toLowerCase().replace(/\s+/g, "-"),
        contentUrl: selectedUrl,
        websiteUrl: selectedUrl,
      });
      saveEvent.notifySuccess();
    });
    microsoftTeams.pages.config.setValidityState(true);
  });

  // Room selection
  document.querySelectorAll(".option").forEach(el => {
    el.addEventListener("click", () => {
      document.querySelectorAll(".option").forEach(o => o.classList.remove("active"));
      el.classList.add("active");
      selectedUrl  = el.dataset.url;
      selectedName = el.dataset.name;
    });
  });
</script>
</body>
</html>
